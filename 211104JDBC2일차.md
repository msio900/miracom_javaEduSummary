# 21.11.04. JDBC-2ì¼ì°¨

## ContentsğŸ“‘

* 



### forë¬¸ê³¼ whieë¬¸ì˜ ì°¨ì´

* `for` : ë°˜ë³µí•˜ëŠ” íšŸìˆ˜ë¥¼ ì´ë¯¸ ì•Œê³  ìˆì„ë•Œ,
* `while` :  ìˆì„ë•Œ ê¹Œì§€, ë°ì´í„°ê°€ ì†Œì§„ë ë•Œê¹Œì§€ ë½‘ì•„ë‚¼ë•Œ!

```mysql
mysql> use scott;
Database changed

mysql> desc custom;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| num   | int(11)      | NO   | PRI | NULL    |       |
| name  | varchar(20)  | NO   |     | NULL    |       |
| addr  | varchar(100) | NO   |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
3 rows in set (0.01 sec)

mysql> SELECT num, name, addr FROM custom;
+-----+-------+-------+
| num | name  | addr  |
+-----+-------+-------+
| 111 | James | NY    |
| 222 | Jane  | Texas |
| 333 | Tom   | NY    |
+-----+-------+-------+
3 rows in set (0.00 sec)
```

```java
package jdbc.test2;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

/*
 * JDBC 4ë‹¨ê³„
 * :
 * 1. ë“œë¼ì´ë²„ ë¡œë”©
 * 2. DBì„œë²„ì™€ ì—°ê²°
 * 3. PreparedStatement ê°ì²´ ìƒì„±
 * 4. ì¿¼ë¦¬ë¬¸...
 * 		int executeUpdate("") -- INSERT, DELETE, UPDATE  -- 0 / 1
 * 		ResultSet executeQuery("") -- SELECT 
 * 			BOE
 * 			ResultSet
 * 			EOE
 */
public class DBConnectionTest {
	DBConnectionTest() throws ClassNotFoundException, SQLException {
		Class.forName("com.mysql.cj.jdbc.Driver"); //FQCN
		System.out.println("1. Driver Loading....");
		
		String url = "jdbc:mysql://127.0.0.1:3306/scott?serverTimezone=UTC&useUnicode=yes&characterEncoding=UTF-8";
		Connection conn = DriverManager.getConnection(url, "root", "1234");
		System.out.println("2. DB Server Connect ....");
		
		String query = "INSERT INTO custom (num, name, addr) VALUES(?,?,?)";
		PreparedStatement ps = conn.prepareStatement(query);
		System.out.println("3. PreparedStatement Creating....");
		
		//?ì— ê°’ì„ ë°”ì¸ë”©
		ps.setInt(1, 444);
		ps.setString(2, "Juliet");
		ps.setString(3, "LA");
		
		System.out.println(ps.executeUpdate()+" row INSERT OK...!");
		
	}
	
	public static void main(String[] args) throws ClassNotFoundException,SQLException{
		new DBConnectionTest();

	}

}
```

* ì¶”ê°€ë¨.

```mysql
mysql> SELECT num, name, addr FROM custom;
+-----+--------+-------+
| num | name   | addr  |
+-----+--------+-------+
| 111 | James  | NY    |
| 222 | Jane   | Texas |
| 333 | Tom    | NY    |
| 444 | Juliet | LA    |
+-----+--------+-------+
4 rows in set (0.00 sec)
```

## ì¿¼ë¦¬ë¬¸ ë‹«ì•„ì£¼ê¸°

```java
package jdbc.test2;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

/*
 * JDBC 5ë‹¨ê³„
 * :
 * 1. ë“œë¼ì´ë²„ ë¡œë”©
 * 2. DBì„œë²„ì™€ ì—°ê²°
 * 3. PreparedStatement ê°ì²´ ìƒì„± -- ì´ë•Œ, ì¿¼ë¦¬ë¬¸ ì¸ìê°’ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤.
 * 		ê°’ ë°”ì¸ë”©
 * 4. ì¿¼ë¦¬ë¬¸...
 * 		int executeUpdate("") -- INSERT, DELETE, UPDATE  -- 0 / 1
 * 		ResultSet executeQuery("") -- SELECT 
 * 			BOE
 * 			ResultSet
 * 			EOE
 * 
 * 5. ìì›ì„ ë‹«ì•„ì¤€ë‹¤.
 * 		close...ì—´ì€ ìˆœì„œ ë°˜ëŒ€ë¡œ ë‹«ì•„ì¤€ë‹¤.
 * 		Connection --> PreparedStatement --> ResultSet
 * 		
 * 		ResultSet ë‹«ê³  --> PreparedStatementë‹«ê³  --> Connectionë‹«ê³ 
 */
public class DBConnectionTest {
	DBConnectionTest() throws ClassNotFoundException, SQLException {
		Connection conn = null;
		PreparedStatement ps = null;
		PreparedStatement ps1 = null;
		ResultSet rs = null;
			
		try {
		Class.forName("com.mysql.cj.jdbc.Driver"); //FQCN
		System.out.println("1. Driver Loading....");
		
		String url = "jdbc:mysql://127.0.0.1:3306/scott?serverTimezone=UTC&useUnicode=yes&characterEncoding=UTF-8";
		conn = DriverManager.getConnection(url, "root", "1234");
		System.out.println("2. DB Server Connect ....");
		
		/*String query = "INSERT INTO custom (num, name, addr) VALUES(?,?,?)";
		ps = conn.prepareStatement(query);
		System.out.println("3. PreparedStatement Creating....");
		
		//?ì— ê°’ì„ ë°”ì¸ë”©
		ps.setInt(1, 444);
		ps.setString(2, "Juliet");
		ps.setString(3, "LA");
		
		System.out.println(ps.executeUpdate()+" row INSERT OK...!");
		*/
		
		//deleteë¬¸ì„ ì‘ì„±...
		String query1 = "DELETE FROM custom WHERE num-?";
		ps1 = conn.prepareStatement(query1);
		ps1.setInt(1, 444);
		System.out.println(ps1.executeUpdate()+" row DELETE OK!!");
		
		// í˜„ì¬ DBí…Œì´ë¸”ì— ìˆëŠ” ë°ì´í„°ë¥¼ ë‹¤ ê°€ì ¸ì™€ì„œ ì¶œë ¥...SELECT
		String query = "SELECT * FROM custom WHERE num=?";
		ps = conn.prepareStatement(query);
		
		ps.setInt(1, 444);
		
		rs = ps.executeQuery();
		if(rs.next()) {
			int num = rs.getInt("num");//ì»¬ëŸ¼ëª… í˜¹ì€ 1
			System.out.println(rs.getInt("num")+", "+rs.getString("name")+", "+rs.getString("addr"));
			}
		}finally {
			rs.close();
			ps.close();
			ps1.close();
			conn.close();
		}
	}
	public static void main(String[] args) throws ClassNotFoundException,SQLException{
		new DBConnectionTest();

	}

}

```

## JDBC 5ë‹¨ê³„

1. ë“œë¼ì´ë²„ ë¡œë”©

2. DBì„œë²„ì™€ ì—°ê²°

3. PreparedStatement ê°ì²´ ìƒì„± -- ì´ë•Œ, ì¿¼ë¦¬ë¬¸ ì¸ìê°’ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤.

   * ê°’ ë°”ì¸ë”©

4. ì¿¼ë¦¬ë¬¸...

   int executeUpdate("") -- INSERT, DELETE, UPDATE  -- 0 / 1

   ResultSet executeQuery("") -- SELECT 

   BOE

   ResultSet

   EOE

5. ìì›ì„ ë‹«ì•„ì¤€ë‹¤.

   close...ì—´ì€ ìˆœì„œ ë°˜ëŒ€ë¡œ ë‹«ì•„ì¤€ë‹¤.

   Connection --> PreparedStatement --> ResultSet

   ResultSet ë‹«ê³  --> PreparedStatementë‹«ê³  --> Connectionë‹«ê³ 



### DAO --> Business Logic(ì•„ì£¼ ì¤‘ìš”í•œ ë¡œì§)

![ëª¨ë“ˆí™”ì™€ ì¬ì‚¬ìš©ì„±](./image/1104-01.png)

## ëª¨ë“ˆí™”

* `interface`ë¡œ ì²˜ë¦¬
* propertiesë¡œ ì²˜ë¦¬

### ìŠ¤í… ë°”ì´ ìŠ¤í…!

1. ëª¨ë“ˆí™”
2. ì‹¬í”ŒMVC

## ëª¨ë¸

![](./image/1104-02.png)

![](./image/1104-03.png)

![](./image/1104-jdbc03_flow.png)